# [Exploit the Unknown Gradually: One-Shot Video-Based Person Re-Identification by Stepwise Learning](https://yu-wu.net/pdf/CVPR2018_Exploit-Unknown-Gradually.pdf)

Pytorch implementation for the [paper](https://yu-wu.net/pdf/CVPR2018_Exploit-Unknown-Gradually.pdf) based on [Open-ReID](https://github.com/Cysu/open-reid)

## Preparation
### Dependencies
- Python 3.6
- PyTorch (version >= 0.2.0)
- h5py, scikit-learn, metric-learn, tqdm

### Download datasets 
- DukeMTMC-VideoReID [[Google Drive]](https://drive.google.com/open?id=1XkhupJuOdZM52CaMjng9JipUr3GSFyQD) [[BaiduYun]](https://pan.baidu.com/) [[Direct Link]](http://45.62.126.139:8080/dukemtmc_videoReID.zip). More details and baseline code for DukeMTMC-VideoReID can be found [here](https://github.com/Yu-Wu/DukeMTMC-VideoReID)
- Mars [[Google Drive]](https://drive.google.com/open?id=1wAzUK0jLQztRc6h95Tpvc9iYwVMM1n8b).
- Move the downloaded zip files to `./data/` and unzip here.


## Train

```shell
# For DukeMTMC-VideoReID
python3 run.py --dataset dukemtmc_videoReID --logs_dir logs/dukemtmc_videoReID_EF_10/ --EF 10 --mode Dissimilarity --max_frames 900
# For Mars
python3 run.py --dataset mars --logs_dir logs/mars_EF_10/ --EF 10 --mode Dissimilarity --max_frames 900
```
It takes about 25 hours with a GTX1080Ti to train EUG with EF=10%. Please set the `max_frames` smaller if your GPU memory is less than 11G.

## Performances

The performances varies according to random splits for initial labeled data. To reproduce the performances in our paper, please use the one-shot split at `./examples/`


## Citation

Please cite the following paper in your publications if it helps your research:

    @inproceedings{wu2018cvpr_oneshot,
        title = {Exploit the Unknown Gradually: One-Shot Video-Based Person Re-Identification by Stepwise Learning},
        author = {Wu, Yu and Lin, Yutian and Dong, Xuanyi and Yan, Yan and Ouyang, Wanli and Yang, Yi},
        booktitle = {The IEEE Conference on Computer Vision and Pattern Recognition (CVPR)},
        year = {2018}
    }

    
## Contact

To report issues for this code, please open an issue on the [issues tracker](https://github.com/Yu-Wu/Exploit-Unknown-Gradually/issues).

If you have further questions about this paper, please do not hesitate to contact me. 

[Yu Wu's Homepage](https://yu-wu.net)
